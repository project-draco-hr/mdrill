{
  if (this.lastquickfieldNumber != fieldNumber) {
    fieldCount.put(this.lastquickfieldNumber,this.termNum);
    fieldPos.put(fieldNumber,this.outputQuickTis.getFilePointer());
    this.ft=this.schemainfo.getField(term.field).getType();
    this.dataType=UnInvertedFieldUtils.getDataType(ft);
    this.lastquickfieldNumber=fieldNumber;
    this.termNum=0;
    this.lastfreqPointer=0;
  }
  if ((this.termNum & TermIndex.intervalMask) == 0) {
    this.outputQuickTis.writeString(term.text());
  }
  if (dataType == Datatype.d_long) {
    long val=Long.parseLong(ft.indexedToReadable(term.text()));
    this.outputQuickTis.writeVVVLong(val);
  }
 else   if (dataType == Datatype.d_double) {
    Double val=MdrillUtils.ParseDouble(ft.indexedToReadable(term.text()));
    this.outputQuickTis.writeVVVLong(Double.doubleToLongBits(val));
  }
 else {
    CRC32 crc32=new CRC32();
    crc32.update(new String(ft.indexedToReadable(term.text())).getBytes());
    this.outputQuickTis.writeVVVLong(crc32.getValue());
  }
  this.outputQuickTis.writeVInt(ti.docFreq);
  this.outputQuickTis.writeVLong(ti.freqPointer - lastfreqPointer);
  lastfreqPointer=ti.freqPointer;
  this.termNum++;
}
