{
  long ts=log.getTs();
  BoltStatKey key=new BoltStatKey(log.getGroup(),ts);
  BoltStatVal val=new BoltStatVal(log.getSum());
  BoltStatVal statval=nolockbuffer.get(key);
  this.status.ttInput++;
  if (statval == null) {
    nolockbuffer.put(key,val);
    this.status.groupCreate++;
  }
 else {
    statval.merger(val);
  }
  if ((this.status.ttInput % 1000 != 0)) {
    return false;
  }
  if (!this.timeoutCheck.istimeout() && nolockbuffer.size() < buffersize && nolockbuffer.size() < buffersize) {
    return false;
  }
  this.timeoutCheck.reset();
  HashMap<BoltStatKey,BoltStatVal> buffer=nolockbuffer;
  LOG.info("####total:group=" + buffer.size() + ",ts:"+ formatHour.format(new Date(ts))+ ",status:"+ this.status.toString());
  nolockbuffer=new HashMap<BoltStatKey,BoltStatVal>(buffersize);
  this.commit.updateAll(buffer,key.getGroupts());
  if (this.status.ttInput > 100000000) {
    this.status.reset();
  }
  return true;
}
