{
  NamedList res=new SimpleOrderedMap();
  String[] facetFs=params.getParams(FacetParams.FACET_FIELD);
  if (null != facetFs) {
    boolean iscross=params.getBool(FacetParams.FACET_CROSS,false);
    if (iscross) {
      boolean isdetail=params.getBool(FacetParams.FACET_CROSS_DETAIL,false);
      if (isdetail) {
        MdrillDetail crossObj=new MdrillDetail(searcher,params,this.req);
        res.add("solrCorssFields_s",crossObj.getBySchemaReader(facetFs,this.base));
      }
 else {
        MdrillGroupBy crossObj=new MdrillGroupBy(searcher,params,this.req);
        res.add("solrCorssFields_s",crossObj.getBySchemaReader(facetFs,this.base));
      }
    }
 else {
      for (      String f : facetFs) {
        NamedList w=getTermCountsUniq(f,this.base,false,false);
        res.add(key,w);
      }
    }
  }
  return res;
}
