{
  if (this.uptopos_compress <= 0) {
    return;
  }
  if (!this.blockmode_compress) {
    for (int i=0; i < uptopos_compress; i++) {
      this.writeVInt(buffer_compress[i]);
    }
    this.uptopos_compress=0;
    return;
  }
  int[] compressedBuffer=PForDelta.compressOneBlock(buffer_compress,uptopos_compress);
  if (printindex_compress++ < 1000) {
    System.out.println("##flushCompressBlock##" + compressedBuffer.length + "@"+ uptopos_compress);
  }
  this.writeVInt(uptopos_compress);
  int[] decompress=PForDelta.decompressOneBlock(compressedBuffer,uptopos_compress);
  if (compressEquals(decompress,buffer_compress,uptopos_compress)) {
    this.writeVInt(compressedBuffer.length);
    for (int i=0; i < compressedBuffer.length; i++) {
      this.writeInt(compressedBuffer[i]);
    }
  }
 else {
    if (printindex_compress_error++ < 1000) {
      System.out.println("##flushCompressBlock error##" + compressedBuffer.length + "@"+ uptopos_compress+ "@"+ printindex_compress_error);
    }
    this.writeVInt(0);
    for (int i=0; i < uptopos_compress; i++) {
      this.writeVInt(buffer_compress[i]);
    }
  }
  this.uptopos_compress=0;
}
