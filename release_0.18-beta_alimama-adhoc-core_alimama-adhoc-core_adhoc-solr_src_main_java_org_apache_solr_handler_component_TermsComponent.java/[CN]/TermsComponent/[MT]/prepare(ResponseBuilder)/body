{
  SolrParams params=rb.req.getParams();
  if (params.getBool(TermsParams.TERMS,false)) {
    rb.doTerms=true;
  }
  String shards=params.get(ShardParams.SHARDS);
  if (shards != null) {
    if (params.get(ShardParams.SHARDS_QT) == null) {
      throw new SolrException(SolrException.ErrorCode.BAD_REQUEST,"No shards.qt parameter specified");
    }
    List<String> lst=StrUtils.splitSmart(shards,",",true);
    rb.shards=lst.toArray(new String[lst.size()]);
  }
}
