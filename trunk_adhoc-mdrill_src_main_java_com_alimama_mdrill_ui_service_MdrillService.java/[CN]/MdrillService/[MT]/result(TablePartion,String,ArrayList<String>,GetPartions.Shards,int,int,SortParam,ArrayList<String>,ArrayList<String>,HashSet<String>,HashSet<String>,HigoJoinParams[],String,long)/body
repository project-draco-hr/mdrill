{
  CommonsHttpSolrServer server=WebServiceParams.makeServer(shard);
  SolrQuery query=WebServiceParams.makeSolrQuery(shard);
  JSONObject jsonObj=new JSONObject();
  long t2=System.currentTimeMillis();
  long timetaken=t2 - t1;
  jsonObj.put("__pretimetaken",timetaken);
  if (groupbyFields.size() == 0 && joins.length > 0) {
    if (commonStatMap.size() > 0 || distStatFieldMap.size() > 0) {
      groupbyFields.add("higoempty_groupby_forjoin_l");
    }
    showFields.add("higoempty_groupby_forjoin_l");
  }
  try {
    if (groupbyFields.size() > 0) {
      resultGroupBy(fqList,shard,start,rows,sortType,groupbyFields,showFields,commonStatMap,distStatFieldMap,joins,query,jsonObj,server);
    }
 else     if (commonStatMap.size() > 0 || distStatFieldMap.size() > 0) {
      ArrayList<String> groupFieldsEmpty=WebServiceParams.groupFields("higoempty_groupby_l");
      WebServiceParams.setGroupByQuery(query,fqList,groupFieldsEmpty,start,rows,distStatFieldMap,commonStatMap,sortType,joins,null);
      LOG.info("queryinfo:" + shard.urlMain + "/select/?"+ cutString(query.toString()));
      QueryResponse qr=server.query(query,SolrRequest.METHOD.POST);
      WebServiceParams.setGroupByResult(query,jsonObj,qr,groupbyFields,showFields,joins,null);
    }
 else {
      WebServiceParams.setDetailByQuery(query,fqList,showFields,start,rows,sortType,joins,mode.indexOf("@fdt@") >= 0);
      LOG.info("queryinfo:" + shard.urlMain + "/select/?"+ cutString(query.toString()));
      QueryResponse qr=WebServiceParams.fetchDetailCrcQr(query,server,jsonObj,"__timedebug");
      WebServiceParams.setDetailResult(jsonObj,qr,showFields,joins);
    }
  }
 catch (  Exception e) {
    SolrInfoList infolist=GetShards.getSolrInfoList(part.name);
    infolist.run();
    LOG.error("higocall,exceptin",e);
    jsonObj.put("code","0");
    jsonObj.put("message",WebServiceParams.errorToString(e));
  }
  if (callback != null && callback.length() > 0) {
    return callback + "(" + jsonObj.toString()+ ")";
  }
 else {
    return jsonObj.toString();
  }
}
