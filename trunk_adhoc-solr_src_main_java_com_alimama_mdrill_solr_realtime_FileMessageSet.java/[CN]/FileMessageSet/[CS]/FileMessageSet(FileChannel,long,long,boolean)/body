{
  super();
  this.channel=channel;
  this.offset=offset;
  this.messageCount=new AtomicLong(0);
  this.sizeInBytes=new AtomicLong(0);
  this.highWaterMark=new AtomicLong(0);
  this.mutable=mutable;
  if (mutable) {
    final long startMs=System.currentTimeMillis();
    final long truncated=this.recover();
    log.info("Recovery succeeded in " + (System.currentTimeMillis() - startMs) / 1000 + " seconds. " + truncated + " bytes truncated.");
  }
 else {
    this.sizeInBytes.set(Math.min(channel.size(),limit) - offset);
    this.highWaterMark.set(this.sizeInBytes.get());
  }
}
