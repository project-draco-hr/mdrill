{
  Cache<ILruMemSizeKey,ILruMemSizeCache> cache=GrobalCache.fieldValueCache;
  ILruMemSizeKey key=new GrobalCache.StringKey("seg@" + partion + "@"+ field+ "@"+ reader.getStringCacheKey()+ "@"+ LuceneUtils.crcKey(reader)+ "@"+ reader.getSegmentName());
  UnInvertedField uif=(UnInvertedField)cache.get(key);
  if (uif == null) {
    TryLock lock=new TryLock(reader.directory());
    try {
      lock.tryLock();
      uif=(UnInvertedField)cache.get(key);
      if (uif == null) {
        uif=new UnInvertedField(field,reader,schema);
        cache.put(key,uif);
      }
    }
  finally {
      lock.unlock();
    }
  }
  uif.refCnt.incrementAndGet();
  return uif;
}
