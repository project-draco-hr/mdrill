{
  final Cache<ILruMemSizeKey,ILruMemSizeCache> cache=GrobalCache.fieldValueCache;
  final ILruMemSizeKey key=new GrobalCache.StringKey("seg@" + String.valueOf(isreadDouble) + "@"+ partion+ "@"+ field+ "@"+ reader.getStringCacheKey()+ "@"+ LuceneUtils.crcKey(reader)+ "@"+ reader.getSegmentName());
  UnInvertedField uif=(UnInvertedField)cache.get(key);
  if (uif == null) {
    ExecutorCompletionService<UnivertPool> serv=new ExecutorCompletionService<UnivertPool>(pool);
    Callable<UnivertPool> task=new Callable<UnivertPool>(){
      public UnivertPool call() throws Exception {
        UnivertPool rtnuif=new UnivertPool();
        try {
          rtnuif.uni=(UnInvertedField)cache.get(key);
          if (rtnuif.uni == null) {
            rtnuif.uni=new UnInvertedField(field,reader,schema,isreadDouble);
            cache.put(key,rtnuif.uni);
          }
        }
 catch (        IOException e) {
          rtnuif.e=e;
        }
 finally {
          rtnuif.isfinish.set(true);
        }
        return rtnuif;
      }
    }
;
    serv.submit(task);
    try {
      UnivertPool rtnuif=serv.take().get();
      if (rtnuif.e != null) {
        throw rtnuif.e;
      }
      uif=rtnuif.uni;
    }
 catch (    Throwable e) {
      throw new IOException(e);
    }
  }
  uif.refCnt.incrementAndGet();
  return uif;
}
