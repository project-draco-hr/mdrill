{
  super.setup(context);
  context.getCounter("higo","dumpcount").increment(0);
  Configuration conf=context.getConfiguration();
  isNotFdtMode=conf.get("mdrill.table.mode","").indexOf("@hdfs@") < 0;
  if (!isNotFdtMode) {
    TermInfosWriter.setSkipInterVal(16);
  }
  heartBeater=new HeartBeater(context);
  heartBeater.needHeartBeat();
  this.doclistcache=new DocumentList();
  this.ramMerger=new RamWriter();
  String fieldStrs=conf.get("higo.index.fields");
  String[] fieldslist=fieldStrs.split(",");
  this.documentConverter=new DocumentConverter(fieldslist,"solrconfig.xml","schema.xml");
  shardWriter=this.initShardWriter(context);
  try {
    this.analyzer=JobIndexPublic.setAnalyzer(conf);
  }
 catch (  Exception e) {
    throw new IOException(e);
  }
}
