{
  if (!key.isNum()) {
    int dumps=0;
    Iterator<DocumentMap> iterator=values.iterator();
    while (iterator.hasNext()) {
      DocumentMap doclist=iterator.next();
      dumps++;
    }
    if (dumps > 1) {
      context.getCounter("higo","dumpcount").increment(1);
      ;
      if (debuglines < 100) {
        debuglines++;
        System.out.println("dumpcount: " + key.toString() + "");
      }
    }
    return;
  }
  lastkey=new IntWritable(key.getIndex());
  Iterator<DocumentMap> iterator=values.iterator();
  while (iterator.hasNext()) {
    if (doccount > maxDocCount) {
      break;
    }
    doclistcache.add(iterator.next(),this.fields);
    if (!doclistcache.isoversize()) {
      continue;
    }
    RamWriter ram=doclistcache.toRamWriter(documentConverter,analyzer,context);
    doclistcache=new DocumentList();
    ramMerger.process(ram);
    if (this.maybeFlush(ramMerger,context,false)) {
      ramMerger=new RamWriter();
      ;
    }
  }
}
