{
  super.setup(context);
  String fieldStrs=context.getConfiguration().get("higo.index.fields");
  split=context.getConfiguration().get("higo.column.split",split);
  String custfields=context.getConfiguration().get("higo.column.custfields","");
  usedthedate=context.getConfiguration().getBoolean("higo.column.userthedate",usedthedate);
  this.thedate=null;
  if (usedthedate) {
    InputSplit inputSplit=context.getInputSplit();
    Path filepath=((FileSplit)inputSplit).getPath();
    String inputbase=context.getConfiguration().get("higo.input.base");
    this.thedate=JobIndexPublic.parseThedate(new Path(inputbase),filepath);
    System.out.println("thedatepath: " + thedate + "@"+ filepath.toString()+ "@"+ inputbase+ "");
  }
  if (custfields == null || custfields.isEmpty()) {
    String[] fieldslist=fieldStrs.split(",");
    this.fields=new String[fieldslist.length];
    this.isDate=new Boolean[fieldslist.length];
    this.isString=new Boolean[fieldslist.length];
    this.isStore=new Boolean[fieldslist.length];
    for (int i=0; i < fieldslist.length; i++) {
      String[] fieldSchema=fieldslist[i].split(":");
      String fieldName=fieldSchema[0].trim().toLowerCase();
      String type=fieldSchema[1];
      this.isStore[i]=Boolean.valueOf(fieldSchema[3]);
      this.fields[i]=fieldName;
      this.isDate[i]=type.equalsIgnoreCase("tdate");
      this.isString[i]=type.equalsIgnoreCase("string");
    }
  }
 else {
    String[] fieldslist=custfields.split(",");
    this.fields=new String[fieldslist.length];
    this.isDate=new Boolean[fieldslist.length];
    this.isString=new Boolean[fieldslist.length];
    this.isStore=new Boolean[fieldslist.length];
    for (int i=0; i < fieldslist.length; i++) {
      this.isStore[i]=Boolean.valueOf(false);
      this.fields[i]=fieldslist[i];
      this.isDate[i]=false;
      this.isString[i]=true;
    }
  }
}
