{
  if (form == null) {
    return false;
  }
  long formSize=form.totalSizeInBytes();
  Integer docs=form.getNumDocs();
  if ((docs >= 1000 && formSize > minsize) || fource) {
    context.getCounter("higo","docCount").increment(docs);
    ;
    doccount+=docs;
    form.closeWriter();
    shardWriter.process(form);
    form.closeDir();
    return true;
  }
  return false;
}
