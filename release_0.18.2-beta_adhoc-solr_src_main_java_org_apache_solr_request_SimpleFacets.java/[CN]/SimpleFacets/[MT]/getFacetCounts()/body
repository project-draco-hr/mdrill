{
  if (!params.getBool(FacetParams.FACET,true))   return null;
  facetResponse=new SimpleOrderedMap();
  try {
    facetResponse.add("facet_queries",getFacetQueryCounts());
    facetResponse.add("facet_fields",getFacetFieldCounts());
    facetResponse.add("facet_dates",getFacetDateCounts());
    facetResponse.add("facet_ranges",getFacetRangeCounts());
  }
 catch (  IOException e) {
    SolrException.logOnce(SolrCore.log,"Exception during facet counts",e);
    throw new SolrException(ErrorCode.SERVER_ERROR,e);
  }
catch (  ParseException e) {
    SolrException.logOnce(SolrCore.log,"Exception during facet counts",e);
    throw new SolrException(ErrorCode.BAD_REQUEST,e);
  }
catch (  Exception e) {
    SolrException.logOnce(SolrCore.log,"Exception during facet counts",e);
    throw new SolrException(ErrorCode.SERVER_ERROR,e);
  }
  return facetResponse;
}
