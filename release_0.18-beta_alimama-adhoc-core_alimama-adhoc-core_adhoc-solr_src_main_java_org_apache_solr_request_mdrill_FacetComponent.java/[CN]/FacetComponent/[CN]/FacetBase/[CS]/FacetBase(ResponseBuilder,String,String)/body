{
  this.facetType=facetType;
  this.facetStr=facetStr;
  try {
    this.localParams=QueryParsing.getLocalParams(facetStr,rb.req.getParams());
  }
 catch (  ParseException e) {
    throw new SolrException(SolrException.ErrorCode.BAD_REQUEST,e);
  }
  this.facetOn=facetStr;
  this.key=facetStr;
  if (localParams != null) {
    if (!facetType.equals(FacetParams.FACET_QUERY)) {
      facetOn=localParams.get(CommonParams.VALUE);
      key=facetOn;
    }
    key=localParams.get(CommonParams.OUTPUT_KEY,key);
  }
}
