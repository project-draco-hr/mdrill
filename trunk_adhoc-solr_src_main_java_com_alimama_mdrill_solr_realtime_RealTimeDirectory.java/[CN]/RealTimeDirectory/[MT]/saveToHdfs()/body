{
  if (this.ishdfsmode) {
    return;
  }
  ConcurrentHashMap<String,DirectoryInfo> buffer=null;
synchronized (diskDirector_hdfs_lock) {
    buffer=diskDirector_hdfs;
    diskDirector_hdfs=new ConcurrentHashMap<String,DirectoryInfo>(diskDirector);
  }
  Configuration conf=this.getConf();
  FileSystem fs=FileSystem.get(conf);
  Path tmpDir=new Path(hdfsPath,"realtime_tmp");
  if (fs.exists(tmpDir)) {
    fs.delete(tmpDir,true);
  }
  fs.mkdirs(tmpDir);
  Path tslocal=new Path(baseDir,"realtime_ts");
  Path tsdst=new Path(tmpDir,"realtime_ts");
  LOG.info("####copyFromLocalFile####" + tslocal.toString() + ","+ tsdst.toString());
  fs.copyFromLocalFile(tslocal,tsdst);
  for (  Entry<String,DirectoryInfo> e : buffer.entrySet()) {
    Path local=new Path(e.getKey());
    Path dst=new Path(tmpDir,local.getName());
    LOG.info("####copyFromLocalFile####" + local.toString() + ","+ dst.toString());
    fs.copyFromLocalFile(local,dst);
  }
  Path realtimefinal=new Path(hdfsPath,"realtime");
  if (fs.exists(realtimefinal)) {
    fs.delete(realtimefinal,true);
  }
  fs.rename(tmpDir,realtimefinal);
  LOG.info("####saveToHdfs####" + realtimefinal.toString() + this.extaLog());
}
