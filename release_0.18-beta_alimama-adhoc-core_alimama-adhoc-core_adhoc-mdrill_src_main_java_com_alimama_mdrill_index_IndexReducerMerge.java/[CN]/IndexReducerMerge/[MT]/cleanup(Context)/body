{
  try {
    shardWriter.addEmptyDoc();
    shardWriter.optimize();
    shardWriter.close();
    Configuration conf=context.getConfiguration();
    FileSystem fs=FileSystem.get(conf);
    if (!fs.exists(new Path(indexHdfsPath))) {
      fs.rename(new Path(tmpath),new Path(indexHdfsPath));
    }
  }
 catch (  Exception e) {
  }
  heartBeater.cancelHeartBeat();
  heartBeater.interrupt();
}
